v9990_p1_test.s1FNAME "v9990_p1_test.rom" 3PageSize: equ 0x4000 56 org 0x4000, 0xbeff 8 Include/RomHeader.s12 db "AB" 3 dw Execute 4 dw 0 6 dw 0 8 dw 0 9 dw 0, 0, 0 10 11v9990_p1_test.s9 Include/V9990.s13V9:5820.PORT_0: equ 0x6021.PORT_1: equ 0x6122.PORT_2: equ 0x6223.PORT_3: equ 0x6324.PORT_4: equ 0x6425.PORT_5: equ 0x6526.PORT_6: equ 0x6627.PORT_7: equ 0x6728323940.P1_PATTBL_LAYER_A: equ 0x00000 41.P1_PATTBL_LAYER_B: equ 0X40000 42.P1_SPRATR: equ 0X3fe00 43.P1_NAMTBL_LAYER_A: equ 0X7c000 44.P1_NAMTBL_LAYER_B: equ 0X7e000 46485051.SetRegister:52 out (V9.PORT_4), a 53 ld a, b54 out (V9.PORT_3), a 55 ret5960.SetVdp_Write:61 ld b, a 63 64 ld a, 0000 0000 b65 di66 out (V9.PORT_4), a68 ld c, V9.PORT_370 71 out (c), e73 74 out (c), d76 77 and 0111 1111 b 78 ei79 out (c), b81 ret8590.LDIRVM:91 push bc92 push af93 94 ld a, 0000 0000 B95 out (V9.PORT_4), a97 ld c, V9.PORT_399 100 out (c), e102 103 out (c), d104 pop af106 107 and 0111 1111 b 108 out (c), a109 pop de111 ld c, V9.PORT_0112.LDIRVM_loop:113 114 outi115 116 dec de117 ld a, e118 or d119 jp nz, .LDIRVM_loop121 ret124125.SetTilePattern:126 push bc127 call V9.SetVdp_Write129 ld c, (V9.PORT_0)131 outi outi outi outi 133 ld bc, 0x80 - 4 134 add hl, bc135 pop bc136 djnz .SetTilePattern138 retv9990_p1_test.s12Execute:14 16 17 ld a, 018 out (V9.PORT_7), a20 24 ld a, 6 25 ld b, 0000 0101 b 26 call V9.SetRegister28 36 ld a, 7 37 ld b, 0000 0000 b 38 call V9.SetRegister41 43 ld a, 8 44 ld b, 1000 0010 b 45 call V9.SetRegister48 49 ld a, 27 50 ld b, 0000 0000 b 51 call V9.SetRegister55 56 ld a, 17 57 ld b, 0000 0000 b 58 call V9.SetRegister60 ld a, 18 61 ld b, 0000 0000 b 62 call V9.SetRegister64 ld a, 19 65 ld b, 0000 0000 b 66 call V9.SetRegister68 ld a, 20 69 ld b, 0000 0000 b 70 call V9.SetRegister72 ld a, 21 73 ld b, 0000 0000 b 74 call V9.SetRegister76 ld a, 22 77 ld b, 0000 0000 b 78 call V9.SetRegister80 ld a, 23 81 ld b, 0000 0000 b 82 call V9.SetRegister84 ld a, 24 85 ld b, 0000 0000 b 86 call V9.SetRegister90 91 ld hl, Tile_0 92 ld a, V9.P1_PATTBL_LAYER_A >> 16 93 ld de, V9.P1_PATTBL_LAYER_A AND 0xffff 94 ld bc, Tile_0.size 95 call V9.LDIRVM 98 99 ld hl, NamesTable_test 100 ld a, V9.P1_NAMTBL_LAYER_A >> 16 101 ld de, V9.P1_NAMTBL_LAYER_A AND 0xffff 102 ld bc, NamesTable_test.size 103 call V9.LDIRVM 106 107 108 112 116 ld a, 13 117 ld b, 0000 00 00 b 118 call V9.SetRegister121 123 124 ld a, 0000 1110 b125 out (V9.PORT_4), a127 128 ld a, 0000 0000 b129 out (V9.PORT_3), a131 134 ld hl, Palette_test135 ld c, V9.PORT_1136 ld b, 16 * 3 137.SetPalette_loop:138 outi 139 outi 140 outi 141 djnz .SetPalette_loop143 jp $ 146148152156159161171173175176Tile_0:177 db 0xff, 0xff, 0xff, 0xff178 db 0xf0, 0x00, 0x00, 0x0f179 db 0xf0, 0x00, 0x00, 0x0f180 db 0xf0, 0x00, 0x00, 0x0f181 db 0xf0, 0x00, 0x00, 0x0f182 db 0xf0, 0x00, 0x00, 0x0f183 db 0xf0, 0x00, 0x00, 0x0f184 db 0xff, 0xff, 0xff, 0xff185.size: equ $ - Tile_0187NamesTable_test:188 dw 0x0000, 0x0000, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1189 212.size: equ $ - NamesTable_test214Palette_test:215 216 db 15, 0, 0217 db 15, 31, 31218 db 15, 0, 31219 db 15, 15, 15221 db 0, 0, 0222 db 31, 0, 0223 db 0, 31, 0224 db 0, 0, 31226 db 31, 15, 15227 db 15, 31, 15228 db 15, 15, 31229 db 15, 0, 0231 db 0, 15, 0232 db 0, 0, 15233 db 0, 7, 0234 db 0, 0, 7238239 ds PageSize - ($ - 0x4000), 255 240