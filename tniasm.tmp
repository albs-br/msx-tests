c:\Users\albs_\source\repos\msx-tests\v9990_p1_test.s1FNAME "v9990_p1_test.rom" 3PageSize: equ 0x4000 56 org 0x4000, 0xbeff 8 Include/RomHeader.s12 db "AB" 3 dw Execute 4 dw 0 6 dw 0 8 dw 0 9 dw 0, 0, 0 10 11c:\Users\albs_\source\repos\msx-tests\v9990_p1_test.s9 Include/V9990.s13V9:5820.PORT_0: equ 0x6021.PORT_1: equ 0x6122.PORT_2: equ 0x6223.PORT_3: equ 0x6324.PORT_4: equ 0x6425.PORT_5: equ 0x6526.PORT_6: equ 0x6627.PORT_7: equ 0x6728323940.P1_PATTBL_LAYER_A: equ 0x00000 41.P1_PATTBL_LAYER_B: equ 0X40000 42.P1_SPRATR: equ 0X3fe00 43.P1_NAMTBL_LAYER_A: equ 0X7c000 44.P1_NAMTBL_LAYER_B: equ 0X7e000 46485051.SetRegister:52 di53 out (V9.PORT_4), a 54 ld a, b55 ei56 out (V9.PORT_3), a 57 ret60626465.ReadRegister:66 di67 out (V9.PORT_4), a 68 ei69 in a, (V9.PORT_3) 70 ret737576.SetVdp_Write:77 ld b, a 79 80 xor a 81 di82 out (V9.PORT_4), a84 ld c, V9.PORT_386 87 out (c), e89 90 out (c), d92 93 and 0111 1111 b 94 ei95 out (c), b97 ret99102107.LDIRVM:108 115 117 120 124 129 push bc130 call .SetVdp_Write131 pop de133 ld c, V9.PORT_0134.LDIRVM_loop:135 136 outi137 138 dec de139 ld a, e140 or d141 jp nz, .LDIRVM_loop143 ret146149.SetTilePattern:150 ld b, 8151.SetTilePattern_loop:152 push af, bc153 call V9.SetVdp_Write155 ld c, (V9.PORT_0)157 outi outi outi outi 159 ex de, hl160 ld bc, 0x80 161 add hl, bc162 ex de, hl164 pop bc, af165 djnz .SetTilePattern_loop167 ret169171.ClearVRAM:172 xor a173 ld de, 0174 call V9.SetVdp_Write176 177 ld bc, 0 178.ClearVRAM_loop:179 xor a180 181 out (v9.PORT_0), a182 out (v9.PORT_0), a183 out (v9.PORT_0), a184 out (v9.PORT_0), a185 out (v9.PORT_0), a186 out (v9.PORT_0), a187 out (v9.PORT_0), a188 out (v9.PORT_0), a190 dec bc191 ld a, b192 or c193 jp nz, .ClearVRAM_loop195 ret197199.Mode_P1:200 202 203 xor a204 out (V9.PORT_7), a206 210 ld a, 6 211 ld b, 0000 0101 b 212 call V9.SetRegister214 222 ld a, 7 223 ld b, 0000 0000 b 224 call V9.SetRegister227 229 ld a, 8 230 ld b, 1000 0010 b 231 call V9.SetRegister234 235 ld a, 27 236 ld b, 0000 0000 b 237 call V9.SetRegister239 ret242245248 249252255 260.SetScroll_Layer_A:262 263 ld a, 17 264 ld b, e 265 call V9.SetRegister267 269 270 ld a, 18 271 ld b, d 272 call V9.SetRegister275 277 278 ld a, 19 279 ld b, 0 280 call V9.SetRegister282 283 ld a, 20 284 ld b, 0 285 call V9.SetRegister287 ret289 294.SetScroll_Layer_B:296 298 ld a, 21 299 ld b, 0000 0000 b 300 call V9.SetRegister302 ld a, 22 303 ld b, 0000 0000 b 304 call V9.SetRegister306 ld a, 23 307 ld b, 0000 0000 b 308 call V9.SetRegister310 ld a, 24 311 ld b, 0000 0000 b 312 call V9.SetRegister314 ret316318321.SetPaletteControlRegister:323 sla b 324 sla b326 or b327 ld b, a329 330 331 333 337 341 342 348 ld a, 13 349 call V9.SetRegister351 ret354357360.LoadPalette:362 ld c, a363 364 365 ld a, 0000 1110 b366 out (V9.PORT_4), a368 ld a, c370 sla a 371 sla a372 sla a373 sla a374 sla a375 sla a377 378 379 382 out (V9.PORT_3), a384 388 ld c, V9.PORT_1389 392 outi outi outi outi outi outi outi outi 393 outi outi outi outi outi outi outi outi 394 outi outi outi outi outi outi outi outi 395 outi outi outi outi outi outi outi outi 396 outi outi outi outi outi outi outi outi 397 outi outi outi outi outi outi outi outi 399 ret401402c:\Users\albs_\source\repos\msx-tests\v9990_p1_test.s12Execute:14 call V9.Mode_P118 19 ld hl, 0 20 ld de, 0 21 call V9.SetScroll_Layer_A23 24 ld hl, 0 25 ld de, 0 26 call V9.SetScroll_Layer_B30 call V9.ClearVRAM34 36 37 ld hl, Tile_Empty 38 ld a, V9.P1_PATTBL_LAYER_A >> 16 39 ld de, V9.P1_PATTBL_LAYER_A AND 0xffff 40 call V9.SetTilePattern42 43 ld hl, Tile_0 44 ld a, 0 + (V9.P1_PATTBL_LAYER_A + 4) >> 16 45 ld de, 0 + (V9.P1_PATTBL_LAYER_A + 4) AND 0xffff 46 call V9.SetTilePattern48 49 ld hl, Tile_1 50 ld a, 0 + (V9.P1_PATTBL_LAYER_A + 0x00400) >> 16 51 ld de, 0 + (V9.P1_PATTBL_LAYER_A + 0x00400) AND 0xffff 52 call V9.SetTilePattern56 58 59 ld hl, Tile_Empty 60 ld a, V9.P1_PATTBL_LAYER_B >> 16 61 ld de, V9.P1_PATTBL_LAYER_B AND 0xffff 62 call V9.SetTilePattern64 65 ld hl, Tile_0 66 ld a, 0 + (V9.P1_PATTBL_LAYER_B + 4) >> 16 67 ld de, 0 + (V9.P1_PATTBL_LAYER_B + 4) AND 0xffff 68 call V9.SetTilePattern70 71 ld hl, Tile_1 72 ld a, 0 + (V9.P1_PATTBL_LAYER_B + 0x00400) >> 16 73 ld de, 0 + (V9.P1_PATTBL_LAYER_B + 0x00400) AND 0xffff 74 call V9.SetTilePattern77 78 ld hl, NamesTable_test 79 ld a, V9.P1_NAMTBL_LAYER_A >> 16 80 ld de, V9.P1_NAMTBL_LAYER_A AND 0xffff 81 ld bc, NamesTable_test.size 82 call V9.LDIRVM 84 85 ld hl, NamesTable_B_test 86 ld a, V9.P1_NAMTBL_LAYER_B >> 16 87 ld de, V9.P1_NAMTBL_LAYER_B AND 0xffff 88 ld bc, NamesTable_B_test.size 89 call V9.LDIRVM 93 ld a, 0 94 ld b, 1 95 call V9.SetPaletteControlRegister99 ld a, 0100 ld hl, Palette_test_0101 call V9.LoadPalette103 ld a, 1104 ld hl, Palette_test_1105 call V9.LoadPalette107 ld a, 2108 ld hl, Palette_test_2109 call V9.LoadPalette111 ld a, 3112 ld hl, Palette_test_3113 call V9.LoadPalette117 121 ld a, 25 123 ld b, 0000 0000 b 124 call V9.SetRegister126 128 129 ld hl, SPRATR_Table_Test 130 ld a, V9.P1_SPRATR >> 16 131 ld de, V9.P1_SPRATR AND 0xffff 132 ld bc, SPRATR_Table_Test.size 133 call V9.LDIRVM 135 136 137 jp $ 140142146150153155165168170172Tile_Empty:173 db 0x00, 0x00, 0x00, 0x00174 db 0x00, 0x00, 0x00, 0x00175 db 0x00, 0x00, 0x00, 0x00176 db 0x00, 0x00, 0x00, 0x00177 db 0x00, 0x00, 0x00, 0x00178 db 0x00, 0x00, 0x00, 0x00179 db 0x00, 0x00, 0x00, 0x00180 db 0x00, 0x00, 0x00, 0x00181.size: equ $ - Tile_Empty183Tile_0:184 db 0x1f, 0xff, 0xff, 0xff185 db 0x20, 0x00, 0x00, 0xff186 db 0x30, 0x00, 0x0f, 0x0f187 db 0x40, 0x00, 0xf0, 0x0f188 db 0x50, 0x0f, 0x00, 0x0f189 db 0x60, 0xf0, 0x00, 0x0f190 db 0x7f, 0x00, 0x00, 0x0f191 db 0x8f, 0xff, 0xff, 0xff192.size: equ $ - Tile_0194Tile_1:195 db 0x00, 0x11, 0x22, 0x33196 db 0x00, 0x11, 0x22, 0x33197 db 0x44, 0x55, 0x66, 0x77198 db 0x44, 0x55, 0x66, 0x77199 db 0x88, 0x99, 0xaa, 0xbb200 db 0x88, 0x99, 0xaa, 0xbb201 db 0xcc, 0xdd, 0xee, 0xff202 db 0xcc, 0xdd, 0xee, 0xff203.size: equ $ - Tile_Empty205207NamesTable_test:208 dw 0, 1, 0,32, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1209 dw 1, 0, 0,32, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1210.size: equ $ - NamesTable_test212NamesTable_B_test:213 216 dw 1, 1, 1, 0,32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0217 dw 1, 1,32, 0,32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0218 dw 1,32,32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0219.size: equ $ - NamesTable_B_test221223Palette_test_0:224 225 db 0, 0, 0226 db 15, 0, 0227 db 15, 31, 31228 db 15, 0, 31230 db 0, 0, 15231 db 31, 0, 0232 db 0, 31, 0233 db 0, 0, 31235 db 31, 15, 15236 db 15, 31, 15237 db 15, 15, 31238 db 15, 0, 0240 db 0, 15, 0241 db 0, 0, 15242 244 db 6, 5, 4245 db 31, 31, 31247Palette_test_1:248 249 db 0, 0, 0250 db 2, 2, 2251 db 4, 4, 4252 db 6, 6, 6254 db 8, 8, 8255 db 10, 10, 10256 db 12, 12, 12257 db 14, 14, 14259 db 16, 16, 16260 db 18, 18, 18261 db 20, 20, 20262 db 22, 22, 22264 db 24, 24, 24265 db 26, 26, 26266 db 28, 28, 28267 db 31, 31, 31269Palette_test_2:270 271 db 0, 0, 0272 db 2, 2, 0273 db 4, 4, 0274 db 6, 6, 0276 db 8, 8, 0277 db 10, 10, 0278 db 12, 12, 0279 db 14, 14, 0281 db 16, 16, 0282 db 18, 18, 0283 db 20, 20, 0284 db 22, 22, 0286 db 24, 24, 0287 db 26, 26, 0288 db 28, 28, 0289 db 31, 31, 0291Palette_test_3:292 293 db 0, 0, 0294 db 2, 0, 0295 db 4, 0, 0296 db 6, 0, 0298 db 8, 0, 0299 db 10, 0, 0300 db 12, 0, 0301 db 14, 0, 0303 db 16, 0, 0304 db 18, 0, 0305 db 20, 0, 0306 db 22, 0, 0308 db 24, 0, 0309 db 26, 0, 0310 db 28, 0, 0311 db 31, 0, 0313315SPRATR_Table_Test:316 325 db 106, 0, 128, 00 0 0 0 0 00 b326 db 106, 0, 128 + 32, 01 0 0 0 0 00 b327 db 106 + 32, 0, 128, 10 0 0 0 0 00 b328 db 106 + 32, 0, 128 + 32, 11 0 0 0 0 00 b329.size: equ $ - SPRATR_Table_Test331333334SpritePattern_Test_1:335 db 0x11, 0x11, 0x88, 0x77, 0x66, 0x55, 0x44, 0x33336 db 0x22, 0x22, 0x88, 0x77, 0x66, 0x55, 0x44, 0x33337 db 0x11, 0x11, 0x88, 0x77, 0x66, 0x55, 0x44, 0x33338 db 0x22, 0x22, 0x88, 0x77, 0x66, 0x55, 0x44, 0x33340 db 0x11, 0x11, 0xee, 0xdd, 0xcc, 0xbb, 0xaa, 0x99341 db 0x22, 0x22, 0xee, 0xdd, 0xcc, 0xbb, 0xaa, 0x99342 db 0x11, 0x11, 0xee, 0xdd, 0xcc, 0xbb, 0xaa, 0x99343 db 0x22, 0x22, 0xee, 0xdd, 0xcc, 0xbb, 0xaa, 0x99345 db 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f346 db 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f347 db 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f348 db 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f350 db 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f351 db 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f352 db 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f353 db 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff354.size: equ $ - SpritePattern_Test_1356357 ds PageSize - ($ - 0x4000), 255 358