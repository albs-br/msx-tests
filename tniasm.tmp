c:\Users\albs_\source\repos\msx-tests\set-palette.s1FNAME "set-palette.rom" 34 org 0x4000, 0xbeff 6 Include/RomHeader.s12 db "AB" 3 dw Execute 4 dw 0 6 dw 0 8 dw 0 9 dw 0, 0, 0 10 11c:\Users\albs_\source\repos\msx-tests\set-palette.s910CHPUT: equ 0x00a211NVBXLN: EQU 0xC912EXTROM: EQU 0x15F13CHGMOD: EQU 0x5F14CHGET: EQU 0x9F15GXPOS: EQU 0xFCB316GYPOS: EQU 0xFCB517ATRBYT: EQU 0xF3F318LOGOPR: EQU 0xFB0219NWRVRM: equ 0x017720WRTVDP: equ 0x004723Execute:24 25 ld a, 526 call CHGMOD28 29 41 42 50 51 52 LD b, 0 53 ld c, 0x09 54 call WRTVDP55 58 60 ld b, 0 61 ld c, 16 62 call wrtvdp63 64 65 ld c, 0x9a 66 ld a, 0x00 67 di68 out (c), a69 ld a, 0x00 70 ei71 out (c), a73 74 ld a, 0x77 75 di76 out (c), a77 ld a, 0x00 78 ei79 out (c), a80 83 ld hl, PaletteData84 call LoadPalette85 88 89 ld hl, 128*191 90 ld a, 0x87 91 call NWRVRM 92 INC HL93 call NWRVRM 94 95 101 102 call DrawPalette103 104 105 CALL CHGET106 107 xor a108 call CHGMOD109 RET111112LoadPalette:113 114 LD b, 0 115 ld c, 16 116 call WRTVDP117 ld c, 0x9a 119 ld b, 16120LoadPalette.loop:121 ld a, (hl)122 di123 out (c), a124 inc hl125 ld a, (hl)126 ei127 out (c), a128 inc hl129 djnz LoadPalette.loop130 131 ret134DrawPalette:135 ld hl, 0136 ld b, 16137 xor a138DrawPalette.loop:139 PUSH HL140 PUSH BC141 push af142 call Draw8x8block143 POP AF144 POP BC145 pop hl146 ld de, 4 147 add hl, de148 ld d, 0x11 149 add a, d150 djnz DrawPalette.loop151 ret154155Draw8x8block:156 ld c, 8157.loop1:158 ld b, 4159.loop:160 call NWRVRM161 inc hl162 djnz .loop163 164 dec c165 ret z166 ld de, 128 - 4167 add hl, de168 jp .loop1169 170 RET172PaletteData:173 174 db 0x00, 0x00 175 db 0x77, 0x00 176 db 0x10, 0x00 177 db 0x20, 0x00 178 db 0x30, 0x00 179 db 0x40, 0x00 180 db 0x50, 0x00 181 db 0x60, 0x00 182 db 0x70, 0x00 183 db 0x11, 0x01 184 db 0x22, 0x02 185 db 0x33, 0x03 186 db 0x77, 0x07 187 db 0x66, 0x06 188 db 0x55, 0x05 189 db 0x44, 0x04 190